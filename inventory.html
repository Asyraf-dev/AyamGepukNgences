<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Inventory System</title>
<style>
/* ===== Global Styles ===== */
body {
  font-family: 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
  background-color: #f5f7fb;
  color: #333;
  padding: 20px;
  margin: 0;
  line-height: 1.6;
}

h1 {
  text-align: center;
  color: #222;
  font-size: 2.2em;
  font-weight: 700;
  margin-bottom: 25px;
  letter-spacing: 0.5px;
}

/* ===== Container ===== */
.container {
  max-width: 1100px;
  margin: 0 auto;
  padding: 30px;
  background-color: #fff;
  border-radius: 12px;
  box-shadow: 0 6px 18px rgba(0, 0, 0, 0.08);
  transition: transform 0.3s ease;
}
.container:hover { transform: translateY(-2px); }

/* ===== Filter Section ===== */
.filter-container {
  display: flex;
  justify-content: flex-end;
  margin-bottom: 20px;
  font-size: 0.95rem;
}
.filter-container label {
  margin-right: 10px;
  font-weight: 600;
  color: #444;
}
.filter-container select {
  padding: 6px 10px;
  border: 1px solid #ccc;
  border-radius: 6px;
  font-size: 0.95rem;
  transition: border-color 0.3s ease;
}
.filter-container select:focus {
  border-color: #007bff;
  outline: none;
}

/* ===== Buttons ===== */
.buttons {
  margin-top: 25px;
  text-align: center;
  padding: 20px 0;
}

.buttons button {
  padding: 12px 22px;
  font-size: 1rem;
  background: linear-gradient(135deg, #28a745, #218838);
  color: white;
  border: none;
  border-radius: 8px;
  cursor: pointer;
  margin: 8px;
  transition: all 0.3s ease;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.1);
}

.buttons button:hover {
  transform: translateY(-4px);
  box-shadow: 0 6px 16px rgba(0, 0, 0, 0.15);
}

.buttons .copy-button { 
  background: linear-gradient(135deg, #007bff, #0056b3); 
}
.buttons .print-button { 
  background: linear-gradient(135deg, #ffc107, #e0a800); 
  color: #333; 
}
.buttons .view-history-button { 
  background: linear-gradient(135deg, #6c757d, #5a6268); 
}

/* Remove sticky behavior on mobile */
@media (max-width: 768px) {
  .buttons {
    position: relative; /* not fixed */
    bottom: auto;
    left: auto;
    width: 100%;
    background: transparent;
    padding: 20px 0;
    box-shadow: none;
  }
  .buttons button {
    margin: 5px;
    font-size: 0.9rem;
    padding: 10px 14px;
  }
}


/* ===== Scroll Button ===== */
.scroll-btn {
  position: fixed;
  bottom: 20px;
  right: 20px;
  background: #007bff;
  color: #fff;
  border: none;
  border-radius: 50%;
  width: 50px;
  height: 50px;
  font-size: 22px;
  cursor: pointer;
  box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
  opacity: 0;
  visibility: hidden;
  transition: all 0.3s ease;
  z-index: 999;
}
.scroll-btn:hover {
  background: #0056b3;
  transform: scale(1.1);
}
.scroll-btn.show-btn {
  opacity: 1;
  visibility: visible;
}

/* ===== Inventory Table ===== */
.inventory-list {
  margin: 30px 0;
  border-collapse: collapse;
  width: 100%;
  border-radius: 10px;
  overflow: hidden;
  box-shadow: 0 4px 12px rgba(0, 0, 0, 0.05);
}
.inventory-list th,
.inventory-list td {
  padding: 14px;
  border-bottom: 1px solid #e6e6e6;
  text-align: center;
}
.inventory-list th {
  background: #f0f2f6;
  font-weight: 600;
  color: #444;
}
.inventory-list tr:nth-child(even) td { background: #fafafa; }
.inventory-list tbody tr:hover {
  background: #f1f7ff;
  cursor: pointer;
  transition: background 0.2s ease;
}

/* ===== Checksheet ===== */
.checksheet {
  margin-top: 40px;
  padding: 20px;
  background-color: #f9fafc;
  border-radius: 10px;
  box-shadow: 0 6px 14px rgba(0, 0, 0, 0.05);
}
.checksheet h2 {
  font-size: 1.6em;
  margin-bottom: 15px;
  color: #222;
  border-bottom: 2px solid #e6e6e6;
  padding-bottom: 8px;
}
.checksheet p#timestamp {
  display: inline-block;
  background: #e9f5ff;
  padding: 6px 12px;
  border-radius: 8px;
  font-size: 0.85rem;
  color: #007bff;
  font-weight: 600;
  margin-bottom: 15px;
}
.checksheet ul {
  list-style-type: none;
  padding: 0;
  margin: 0;
}
.checksheet ul li {
  padding: 12px 0;
  font-size: 1.05em;
  display: flex;
  justify-content: space-between;
  align-items: center;
  border-bottom: 1px solid #e6e6e6;
  transition: all 0.3s ease;
}
.checksheet li:last-child { border-bottom: none; }
.checksheet li span { flex: 2; color: #444; }
.checksheet li input[type="number"],
.checksheet li select {
  width: 110px;
  padding: 7px;
  margin-left: 10px;
  font-size: 0.95em;
  border-radius: 6px;
  border: 1px solid #ccc;
  outline: none;
  transition: border-color 0.3s ease;
}
.checksheet li input:focus,
.checksheet li select:focus { border-color: #007bff; }

/* Animation for add/remove */
.checksheet ul li.added {
  background: #e6f7ff;
  animation: fadeIn 0.5s ease;
}
.checksheet ul li.removed {
  opacity: 0;
  transform: translateX(-20px);
  transition: all 0.3s ease;
}
@keyframes fadeIn {
  from { opacity: 0; transform: translateY(10px); }
  to { opacity: 1; transform: translateY(0); }
}

/* ===== Category Colors ===== */
.category-vegetables { background: #e8f7e4; }
.category-spices { background: #fff0f0; }
.category-staples { background: #fff8e1; }
.category-dairy { background: #eaf4fd; }
.category-meats { background: #fdeaea; }
.category-seasoning { background: #f0e6ff; }
.category-nonfood { background: #f4f4f4; }

/* ===== Category Badges ===== */
.category-badge {
  display: inline-block;
  padding: 4px 10px;
  border-radius: 12px;
  font-size: 0.85rem;
  font-weight: 600;
  margin-right: 10px;
}
.category-vegetables .category-badge { background: #d4f3d4; color: #2e7d32; }
.category-spices .category-badge { background: #ffe0e0; color: #c62828; }
.category-staples .category-badge { background: #fff3cd; color: #856404; }
.category-dairy .category-badge { background: #e0f0ff; color: #0056b3; }
.category-meats .category-badge { background: #fde2e2; color: #b71c1c; }
.category-seasoning .category-badge { background: #efe0ff; color: #6a1b9a; }
.category-nonfood .category-badge { background: #e9ecef; color: #495057; }

/* ===== Remove Button ===== */
.remove-btn {
  background: none;
  border: none;
  color: #dc3545;
  font-size: 1.2rem;
  cursor: pointer;
  margin-left: 10px;
  transition: transform 0.2s ease;
}
.remove-btn:hover { transform: scale(1.2); }

/* ===== Responsive Scaling ===== */

/* Tablets */
@media (max-width: 992px) {
  body {
    font-size: 0.95rem;
  }
  h1 {
    font-size: 1.8em;
  }
  .container {
    padding: 20px;
  }
  .inventory-list th, 
  .inventory-list td {
    font-size: 0.9rem;
    padding: 10px;
  }
  .checksheet h2 {
    font-size: 1.3em;
  }
  .checksheet ul li {
    font-size: 0.95em;
  }
}

/* Phones */
@media (max-width: 768px) {
  body {
    font-size: 0.9rem;
  }
  h1 {
    font-size: 1.6em;
  }
  .container {
    padding: 15px;
  }
  .inventory-list th, 
  .inventory-list td {
    font-size: 0.85rem;
    padding: 8px;
  }
  .checksheet h2 {
    font-size: 1.2em;
  }
  .checksheet ul li {
    font-size: 0.9em;
  }
}

/* Small Phones */
@media (max-width: 480px) {
  body {
    font-size: 0.85rem;
  }
  h1 {
    font-size: 1.3em;
  }
  .container {
    padding: 10px;
  }
  .inventory-list th, 
  .inventory-list td {
    font-size: 0.8rem;
    padding: 6px;
  }
  .checksheet h2 {
    font-size: 1.1em;
  }
  .checksheet ul li {
    font-size: 0.85em;
  }
}
/* ===== General Styles ===== */
#checksheetList {
  margin-top: 20px;
  padding: 10px;
}

#checksheetList h3 {
  margin: 10px 0;
  padding: 8px 12px;
  border-radius: 8px;
  font-size: 1.2rem;
  display: inline-block;
  font-weight: bold;
  color: #fff;
}

/* ===== Category Group Headers ===== */
#barang_pasaran-section h3 {
  background: #4CAF50; /* Green */
}

#barang_runcit-section h3 {
  background: #2196F3; /* Blue */
}

#barang_kering-section h3 {
  background: #FF9800; /* Orange */
}

/* ===== Item List ===== */
#checksheetList ul {
  list-style: none;
  padding-left: 0;
  margin-top: 10px;
}

#checksheetList li {
  display: flex;
  align-items: center;
  gap: 10px;
  background: #f9f9f9;
  padding: 6px 10px;
  margin: 5px 0;
  border-radius: 6px;
  border-left: 4px solid #ccc;
  transition: 0.2s ease;
}

#checksheetList li:hover {
  background: #f1f1f1;
  transform: translateX(4px);
}

/* Quantity input */
#checksheetList li input[type="number"] {
  width: 60px;
  padding: 4px;
  border-radius: 4px;
  border: 1px solid #ccc;
  text-align: center;
}

/* Unit dropdown */
#checksheetList li select {
  padding: 4px 6px;
  border-radius: 4px;
  border: 1px solid #ccc;
  background: #fff;
}

/* Remove button */
#checksheetList li .remove-btn {
  background: #e53935;
  color: #fff;
  border: none;
  padding: 4px 8px;
  border-radius: 4px;
  cursor: pointer;
  transition: 0.2s ease;
}

#checksheetList li .remove-btn:hover {
  background: #c62828;
}


</style>


  <!-- Firebase SDK -->
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-database.js"></script>

</head>
<body>
  <div class="container">
    <h1>📦 Inventory System</h1>

    <!-- Filter Section -->
    <div class="filter-container">
      <label for="categoryFilter">Filter by Category:</label>
      <select id="categoryFilter" onchange="filterItems()">
        <option value="all">All Items</option>
        <option value="barang_pasaran">Barang Pasar 🥬</option>
        <option value="barang_runcit">Barang Runcit 🛒</option>
        <option value="barang_kering">Barang Kering 📦</option>
      </select>
    </div>

    <!-- Inventory Table -->
    <div class="card">
      <h2>📝 Inventory List</h2>
      <table class="inventory-list" id="inventoryTable">
        <thead>
          <tr>
            <th>Item</th>
            <th>Select</th>
          </tr>
        </thead>
        <tbody>
          <!-- Dynamic Inventory Items will be loaded here -->
        </tbody>
      </table>
    </div>

    <!-- Checksheet Section -->
    <div class="card checksheet">
      <h2>✅ Checksheet Items for Today</h2>
      <p id="timestamp"></p> <!-- Timestamp will be displayed here -->
      <ul id="checksheetList">
        <!-- Selected items with quantities will be listed here -->
      </ul>
    </div>

    <!-- Action Buttons -->
    <div class="buttons">
      <button class="primary-btn" onclick="copyChecksheet()">📋 Copy</button>
      <button class="secondary-btn" onclick="printChecksheet()">🖨️ Print</button>
      <button class="success-btn" onclick="saveToFirebase()">💾 Save</button>
      <button class="info-btn" onclick="window.location.href='inventoryhistory.html';">📜 View History</button>
      <button class="warning-btn" onclick="window.location.href='display.html';">📊 Order View</button>
    </div>
  </div>

  <!-- Scroll to Bottom Button -->
  <button id="scrollBottomBtn" onclick="scrollToBottom()" class="scroll-btn">⬇️</button>



  <script>
    // Map items into finer categories with emoji + css class
const categoryMap = {
  Vegetables: ["Kobis","Timun","Limau","Daun Sup","Daun Pandan","Salad"],
  Spices: ["Halia","Kunyit Hidup","Lengkuas","Serai","Serbuk Kunyit","Cili Padi","Cili Masak","Cili Padi Masak","Ketumbar","Buah Keras"],
  Protein: ["Tempe","Daging","Bebola Bakso","Ayam"],
  Staples: ["Gula","Garam","Beras","Tepung Gandung"],
  Drinks: ["Susu","Sirap","Teh","Kopi","Sunquick","Nescaffe","Laici","Extra Mangga","Extra Anggur","Cincau"],
  Seasoning: ["Ajinomoto","Tumix Pati Ayam","Maggi Cukup Rasa","Maggi","Kicap","Sos Cili","Selalsih"],
  NonFood: ["Sabun Daia","Sabun Sunlight","Kertas C","Kertas D","Polistrine","Bowl Bakso","Sudu Plastik","Garfu Pelastik","Plastik 12x16","Plastik 16x19","Plastik 6x7","Plastik 7x8","Plastik Singlet 4.5","Plastik Kicap","Getah Belacan","Pen & Maker","Suun"]
};

const emojiMap = {
  Vegetables: "🥦",
  Spices: "🌶️",
  Protein: "🍗",
  Staples: "🍚",
  Drinks: "🥛",
  Seasoning: "🧂",
  NonFood: "🧼"
};

const cssClassMap = {
  Vegetables: "category-vegetables",
  Spices: "category-spices",
  Protein: "category-meats",
  Staples: "category-staples",
  Drinks: "category-dairy",
  Seasoning: "category-seasoning",
  NonFood: "category-nonfood"
};

    // Firebase configuration
    const firebaseConfig = {
      apiKey: "AIzaSyC8piEU-44jNKKaiWZlp2mEmDFwbO6FsrY",
      authDomain: "inventory-change-1f2c9.firebaseapp.com",
      databaseURL: "https://inventory-change-1f2c9-default-rtdb.firebaseio.com",
      projectId: "inventory-change-1f2c9",
      storageBucket: "inventory-change-1f2c9.firebasestorage.app",
      messagingSenderId: "657658084944",
      appId: "1:657658084944:web:77898bcda22fcddf275b55",
      measurementId: "G-1BRQB0GFJX"
    };

    // Initialize Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.database();

    // Inventory Data
    const inventoryData = {
      barang_pasaran: [
        { name: "Kobis" },
        { name: "Timun" },
        { name: "Limau" },
        { name: "Daun Sup" },
        { name: "Daun Pandan" },
        { name: "Salad" },
        { name: "Halia" },
        { name: "Kunyit Hidup" },
        { name: "Lengkuas" },
        { name: "Serai" },
        { name: "Tempe" },
        { name: "Serbuk Kunyit" },
        { name: "Cili Padi" },
        { name: "Cili Masak" },
        { name: "Cili Padi Masak" },
        { name: "Suun" },
        { name: "Cincau" }
      ],
      barang_runcit: [
        { name: "Gula" },
        { name: "Susu" },
        { name: "Garam" },
        { name: "Ajinomoto" },
        { name: "Tumix Pati Ayam" },
        { name: "Maggi Cukup Rasa" },
        { name: "Tepung Gandung" },
        { name: "Sabun Daia" },
        { name: "Sabun Sunlight" },
        { name: "Beras" },
        { name: "Maggi" },
        { name: "Sirap" },
        { name: "Teh" },
        { name: "Kopi" },
        { name: "Sunquick" },
        { name: "Selalsih" },
        { name: "Nescaffe" },
        { name: "Laici" },
        { name: "Extra Mangga" },
        { name: "Extra Anggur" },
        { name: "Ketumbar" },
        { name: "Buah Keras" },
        { name: "Kicap" },
        { name: "Kertas C" },
        { name: "Kertas D" },
        { name: "Sos Cili" },
        { name: "Polistrine" },
        { name: "Bowl Bakso" },
        { name: "Sudu Plastik" },
        { name: "Garfu Pelastik" },
        { name: "Plastik 12x16" },
        { name: "Plastik 16x19" },
        { name: "Plastik 6x7" },
        { name: "Plastik 7x8" },
        { name: "Plastik Singlet 4.5" },
        { name: "Plastik Kicap" },
        { name: "Getah Belacan" },
        { name: "Pen & Maker" },
        { name: "Daging" }
      ],
      barang_kering: [
        { name: "Bebola Bakso" },
        { name: "Ayam" }
      ]
    };
    
      function scrollToBottom() {
    window.scrollTo({
      top: document.body.scrollHeight,
      behavior: 'smooth'
    });
  }

  // Function to handle scroll event and show the button when scrolled down
  window.onscroll = function () {
    const scrollBtn = document.getElementById("scrollBottomBtn");
    if (document.body.scrollTop > 100 || document.documentElement.scrollTop > 100) {
      scrollBtn.classList.add("show-btn"); // Show button
    } else {
      scrollBtn.classList.remove("show-btn"); // Hide button
    }
  };


    // Function to display the items in the table
    function displayItems(category = 'all') {
      const tableBody = document.getElementById("inventoryTable").getElementsByTagName("tbody")[0];
      tableBody.innerHTML = ''; // Clear existing items

      let filteredItems = [];
      if (category === 'all') {
        filteredItems = [
          ...inventoryData.barang_pasaran,
          ...inventoryData.barang_runcit,
          ...inventoryData.barang_kering
        ];
      } else {
        filteredItems = inventoryData[category];
      }

      filteredItems.forEach(item => {
        const row = tableBody.insertRow();
        const cell1 = row.insertCell(0);
        cell1.textContent = item.name;

        const cell2 = row.insertCell(1);
        const checkbox = document.createElement("input");
        checkbox.type = "checkbox";
        checkbox.onclick = () => addToChecksheet(item.name);
        cell2.appendChild(checkbox);
      });
    }

// Function to add selected item to checksheet (3 groups only)
function addToChecksheet(itemName) {
  const checksheetList = document.getElementById("checksheetList");

  // Prevent duplicates
  if ([...checksheetList.querySelectorAll("li")].some(li => li.textContent.includes(itemName))) {
    return;
  }

  // Decide which group this item belongs to
  let group = "barang_kering"; // default
  if (inventoryData.barang_pasaran.some(i => i.name === itemName)) {
    group = "barang_pasaran";
  } else if (inventoryData.barang_runcit.some(i => i.name === itemName)) {
    group = "barang_runcit";
  }

  // Group headers with emoji
  const groupMap = {
    barang_pasaran: { title: "Barang Pasar", emoji: "🥬" },
    barang_runcit: { title: "Barang Runcit", emoji: "🛒" },
    barang_kering: { title: "Barang Kering", emoji: "📦" }
  };

  // Check if group section exists
  let groupSection = document.getElementById(`${group}-section`);
  if (!groupSection) {
    groupSection = document.createElement("div");
    groupSection.id = `${group}-section`;
    groupSection.innerHTML = `<h3>${groupMap[group].emoji} ${groupMap[group].title}</h3><ul></ul>`;
    checksheetList.appendChild(groupSection);
  }

  const ul = groupSection.querySelector("ul");

  // Create list item
  const li = document.createElement("li");

  // Item label
  const itemText = document.createElement("span");
  itemText.textContent = itemName;
  li.appendChild(itemText);

  // Quantity input
  const quantityInput = document.createElement("input");
  quantityInput.type = "number";
  quantityInput.value = 1;
  li.appendChild(quantityInput);

  // Unit dropdown
  const unitSelect = document.createElement("select");
  ["pcs","kg"].forEach(unit => {
    const opt = document.createElement("option");
    opt.value = unit;
    opt.textContent = unit;
    unitSelect.appendChild(opt);
  });
  li.appendChild(unitSelect);

  // Remove button
  const removeBtn = document.createElement("button");
  removeBtn.textContent = "❌";
  removeBtn.classList.add("remove-btn");
  removeBtn.onclick = () => li.remove();
  li.appendChild(removeBtn);

  ul.appendChild(li);
}


  // Function to capitalize the first letter of each word in the string
  function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
  }

    // Function to filter items by category
    function filterItems() {
      const category = document.getElementById("categoryFilter").value;
      displayItems(category);
    }

    // Add timestamp
    function addTimestamp() {
      const timestamp = new Date().toLocaleString();
      document.getElementById("timestamp").textContent = `Generated on: ${timestamp}`;
    }

    // Copy checksheet to clipboard with proper categorization
  function copyChecksheet() {
    const checksheetItems = [];
    const checksheetList = document.getElementById("checksheetList").children;

    // Loop through each category section and its items
    for (let i = 0; i < checksheetList.length; i++) {
      const categorySection = checksheetList[i];
      const categoryTitle = categorySection.querySelector("h3").textContent;
      const items = categorySection.querySelectorAll("li");

      // Add category title to the list
      checksheetItems.push(`${categoryTitle}:`);

      // Loop through each item in the category
      items.forEach(item => {
        const itemName = item.children[0].textContent;
        const quantity = item.children[1].value;
        const unit = item.children[2].value;
        checksheetItems.push(`${itemName} - ${quantity} ${unit}`);
      });

      checksheetItems.push(""); // Add an empty line between categories
    }

    // Add timestamp
    const timestamp = new Date().toLocaleString();
    checksheetItems.unshift(`Generated on: ${timestamp}\n`); // Add timestamp at the top
    const checksheetText = checksheetItems.join("\n");

    // Copy to clipboard
    navigator.clipboard.writeText(checksheetText).then(() => {
      alert('Checksheet copied to clipboard!');
    });
  }

  // Print checksheet with proper categorization
  function printChecksheet() {
    const checksheetItems = [];
    const checksheetList = document.getElementById("checksheetList").children;

    // Loop through each category section and its items
    for (let i = 0; i < checksheetList.length; i++) {
      const categorySection = checksheetList[i];
      const categoryTitle = categorySection.querySelector("h3").textContent;
      const items = categorySection.querySelectorAll("li");

      // Add category title to the list
      checksheetItems.push(`<h3>${categoryTitle}</h3>`);

      // Loop through each item in the category
      items.forEach(item => {
        const itemName = item.children[0].textContent;
        const quantity = item.children[1].value;
        const unit = item.children[2].value;
        checksheetItems.push(`<p>${itemName} - ${quantity} ${unit}</p>`);
      });

      checksheetItems.push(""); // Add an empty line between categories
    }

    // Add timestamp
    const timestamp = new Date().toLocaleString();
    const printContent = `<html><head><title>Print Checksheet</title><style>
                            body { font-family: Arial, sans-serif; padding: 20px; font-size: 16px; }
                            h3 { margin-top: 20px; }
                            p { margin-bottom: 5px; }
                            .timestamp { text-align: center; font-size: 14px; margin-bottom: 20px; }
                          </style></head><body>
                          <h2>Checksheet Items for Today</h2>
                          <p class="timestamp">Generated on: ${timestamp}</p>
                          ${checksheetItems.join("")}
                          </body></html>`;

    // Open the print window and trigger print
    const printWindow = window.open('', '', 'height=600,width=800');
    printWindow.document.write(printContent);
    printWindow.document.close();
    printWindow.print();
  }

  // Save checksheet to Firebase with proper categorization
function saveToFirebase() {
  const checksheetItems = [];
  const checksheetList = document.getElementById("checksheetList").children;

  // Loop through each category section and its items
  for (let i = 0; i < checksheetList.length; i++) {
    const categorySection = checksheetList[i];
    const categoryTitle = categorySection.querySelector("h3").textContent;
    const items = categorySection.querySelectorAll("li");

    items.forEach(item => {
      const itemName = item.children[0].textContent;
      const quantity = item.children[1].value;
      const unit = item.children[2].value;

      checksheetItems.push({
        category: categoryTitle,
        item: itemName,
        quantity: quantity,
        unit: unit
      });
    });
  }

  // Save to Firebase
  const today = new Date().toISOString().split('T')[0]; // Get today's date (YYYY-MM-DD)
  const ref = db.ref('checklists/' + today);

  // Get the existing data for today's date (if any) and append the new items
  ref.once('value', (snapshot) => {
    const existingItems = snapshot.val() ? snapshot.val().items : [];
    const allItems = existingItems.concat(checksheetItems); // Combine existing and new items

    // Update Firebase with the combined items
    ref.update({
      items: allItems
    }, (error) => {
      if (error) {
        alert('Error saving to Firebase: ' + error);
      } else {
        alert('Checksheet saved to Firebase successfully!');
      }
    });
  });
}

    // Initialize the page by displaying all items and adding timestamp
    window.onload = () => {
      displayItems(); // Show all items on page load
      addTimestamp(); // Add timestamp to the checksheet
    };
  </script>
</body>
</html>
